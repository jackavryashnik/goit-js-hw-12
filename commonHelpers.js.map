{"version":3,"file":"commonHelpers.js","sources":["../src/img/bi_x-octagon.svg","../src/main.js"],"sourcesContent":["export default \"__VITE_ASSET__3108d0c6__\"","import 'simplelightbox/dist/simple-lightbox.min.css';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport icon from './img/bi_x-octagon.svg';\nimport iziToast from 'izitoast';\nimport axios from 'axios';\n\nconst input = document.querySelector('.search-input');\nconst form = document.querySelector('.search-form');\nconst gallery = document.querySelector('.gallery');\nlet page = 1;\nlet currentURL = '';\nlet totalPages = 0;\nconst request = {\n  key: '41300766-2a2685b0426849001fa971f21',\n  q: '',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  per_page: 40,\n};\nconst lightboxOptions = {\n  overlayOpacity: 0.8,\n  captionsData: 'alt',\n  captionDelay: 250,\n};\nlet URL = `https://pixabay.com/api/?`;\nconst lightbox = new SimpleLightbox('.gallery a', lightboxOptions);\n\nconst removeElemenyBySelector = selestor => {\n  if (document.querySelector(selestor))\n    document.querySelector(selestor).remove();\n};\n\nconst getImagesFromAPI = async (url, scrollHight) => {\n  await axios\n    .get(url)\n    .then(({ data }) => {\n      if (!data.totalHits) {\n        iziToast.error({\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n          backgroundColor: '#EF4040',\n          messageColor: '#FAFAFB',\n          position: 'topRight',\n          iconUrl: icon,\n          iconColor: '#ffffff',\n          maxWidth: 432,\n          messageSize: 16,\n        });\n\n        removeElemenyBySelector('.loader');\n        removeElemenyBySelector('.load-more-btn');\n\n        gallery.innerHTML = '';\n        return;\n      }\n\n      totalPages = Math.ceil(data.totalHits / request.per_page);\n\n      if (data.hits.length < request.per_page || page === totalPages) {\n        iziToast.info({\n          message: \"We're sorry, but you've reached the end of search results.\",\n          position: 'topRight',\n          maxWidth: 432,\n          messageSize: 16,\n        });\n\n        removeElemenyBySelector('.loader');\n        removeElemenyBySelector('.load-more-btn');\n\n        if (data.hits.length <= request.per_page && data.hits.length > 0) {\n          renderMarkup(data);\n        }\n\n        return;\n      }\n\n      renderMarkup(data);\n\n      window.scrollBy({\n        top: scrollHight,\n        behavior: 'smooth',\n      });\n    })\n    .catch(error => {\n      removeElemenyBySelector('.loader');\n      console.log(error);\n    });\n};\n\nform.addEventListener('submit', event => {\n  event.preventDefault();\n\n  if (!input.value) return;\n\n  gallery.innerHTML = '';\n  request.q = input.value;\n\n  gallery.insertAdjacentHTML('afterend', `<span class=\"loader\"></span>`);\n  removeElemenyBySelector('.load-more-btn');\n\n  page = 1;\n\n  currentURL = URL + new URLSearchParams(request) + `&page=${page}`;\n  input.value = '';\n  getImagesFromAPI(currentURL, 0);\n});\n\nconst renderMarkup = data => {\n  let markup = data.hits.reduce(\n    (\n      html,\n      { webformatURL, largeImageURL, tags, likes, views, comments, downloads }\n    ) => {\n      return (\n        html +\n        `<li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=${largeImageURL}>\n          <img class=\"gallery-image\" src=${webformatURL} data-source=${largeImageURL} alt=\"${tags}\" width=\"360\" height=\"200\"/>\n          <ul class=\"image-stats\">\n            <li class=\"stats-item\"><h3 class=\"stat-title\">Likes</h3><p class=\"stat-value\">${likes}</p></li>\n            <li class=\"stats-item\"><h3 class=\"stat-title\">Views</h3><p class=\"stat-value\">${views}</p></li>\n            <li class=\"stats-item\"><h3 class=\"stat-title\">Comments</h3><p class=\"stat-value\">${comments}</p></li>\n            <li class=\"stats-item\"><h3 class=\"stat-title\">Downloads</h3><p class=\"stat-value\">${downloads}</p></li>\n          </ul>  \n          </a>\n        </li>`\n      );\n    },\n    ''\n  );\n\n  removeElemenyBySelector('.load-more-btn');\n  removeElemenyBySelector('.loader');\n  gallery.insertAdjacentHTML('beforeend', markup);\n\n  gallery.insertAdjacentHTML(\n    'afterend',\n    `<button type=\"submit\" class=\"load-more-btn\">Load more</button>`\n  );\n\n  document.querySelector('.load-more-btn').addEventListener('click', () => {\n    gallery.insertAdjacentHTML('afterend', `<span class=\"loader\"></span>`);\n    page += 1;\n\n    currentURL = URL + new URLSearchParams(request) + `&page=${page}`;\n    const scrollHight =\n      document.querySelector('.gallery-item').getBoundingClientRect().height *\n      2;\n\n    getImagesFromAPI(currentURL, scrollHight);\n  });\n\n  if (\n    (document.querySelector('.load-more-btn') &&\n      data.hits.length > request.per_page) ||\n    (document.querySelector('.load-more-btn') && page === totalPages)\n  ) {\n    removeElemenyBySelector('.load-more-btn');\n  }\n\n  lightbox.refresh();\n};\n"],"names":["icon","input","form","gallery","page","currentURL","totalPages","request","lightboxOptions","URL","lightbox","SimpleLightbox","removeElemenyBySelector","selestor","getImagesFromAPI","url","scrollHight","axios","data","iziToast","renderMarkup","error","event","markup","html","webformatURL","largeImageURL","tags","likes","views","comments","downloads"],"mappings":"+vBAAA,MAAeA,EAAA,kDCOTC,EAAQ,SAAS,cAAc,eAAe,EAC9CC,EAAO,SAAS,cAAc,cAAc,EAC5CC,EAAU,SAAS,cAAc,UAAU,EACjD,IAAIC,EAAO,EACPC,EAAa,GACbC,EAAa,EACjB,MAAMC,EAAU,CACd,IAAK,qCACL,EAAG,GACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,EACZ,EACMC,EAAkB,CACtB,eAAgB,GAChB,aAAc,MACd,aAAc,GAChB,EACA,IAAIC,EAAM,4BACV,MAAMC,EAAW,IAAIC,EAAe,aAAcH,CAAe,EAE3DI,EAA0BC,GAAY,CACtC,SAAS,cAAcA,CAAQ,GACjC,SAAS,cAAcA,CAAQ,EAAE,OAAM,CAC3C,EAEMC,EAAmB,MAAOC,EAAKC,IAAgB,CACnD,MAAMC,EACH,IAAIF,CAAG,EACP,KAAK,CAAC,CAAE,KAAAG,KAAW,CAClB,GAAI,CAACA,EAAK,UAAW,CACnBC,EAAS,MAAM,CACb,QACE,2EACF,gBAAiB,UACjB,aAAc,UACd,SAAU,WACV,QAASnB,EACT,UAAW,UACX,SAAU,IACV,YAAa,EACvB,CAAS,EAEDY,EAAwB,SAAS,EACjCA,EAAwB,gBAAgB,EAExCT,EAAQ,UAAY,GACpB,MACD,CAID,GAFAG,EAAa,KAAK,KAAKY,EAAK,UAAYX,EAAQ,QAAQ,EAEpDW,EAAK,KAAK,OAASX,EAAQ,UAAYH,IAASE,EAAY,CAC9Da,EAAS,KAAK,CACZ,QAAS,6DACT,SAAU,WACV,SAAU,IACV,YAAa,EACvB,CAAS,EAEDP,EAAwB,SAAS,EACjCA,EAAwB,gBAAgB,EAEpCM,EAAK,KAAK,QAAUX,EAAQ,UAAYW,EAAK,KAAK,OAAS,GAC7DE,EAAaF,CAAI,EAGnB,MACD,CAEDE,EAAaF,CAAI,EAEjB,OAAO,SAAS,CACd,IAAKF,EACL,SAAU,QAClB,CAAO,CACP,CAAK,EACA,MAAMK,GAAS,CACdT,EAAwB,SAAS,EACjC,QAAQ,IAAIS,CAAK,CACvB,CAAK,CACL,EAEAnB,EAAK,iBAAiB,SAAUoB,GAAS,CACvCA,EAAM,eAAc,EAEfrB,EAAM,QAEXE,EAAQ,UAAY,GACpBI,EAAQ,EAAIN,EAAM,MAElBE,EAAQ,mBAAmB,WAAY,8BAA8B,EACrES,EAAwB,gBAAgB,EAExCR,EAAO,EAEPC,EAAaI,EAAM,IAAI,gBAAgBF,CAAO,EAAI,SAASH,IAC3DH,EAAM,MAAQ,GACda,EAAiBT,EAAY,CAAC,EAChC,CAAC,EAED,MAAMe,EAAeF,GAAQ,CAC3B,IAAIK,EAASL,EAAK,KAAK,OACrB,CACEM,EACA,CAAE,aAAAC,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,IAGtEP,EACA;AAAA,uCAC+BE;AAAA,2CACID,iBAA4BC,UAAsBC;AAAA;AAAA,4FAEDC;AAAA,4FACAC;AAAA,+FACGC;AAAA,gGACCC;AAAA;AAAA;AAAA,eAM5F,EACJ,EAEEnB,EAAwB,gBAAgB,EACxCA,EAAwB,SAAS,EACjCT,EAAQ,mBAAmB,YAAaoB,CAAM,EAE9CpB,EAAQ,mBACN,WACA,gEACJ,EAEE,SAAS,cAAc,gBAAgB,EAAE,iBAAiB,QAAS,IAAM,CACvEA,EAAQ,mBAAmB,WAAY,8BAA8B,EACrEC,GAAQ,EAERC,EAAaI,EAAM,IAAI,gBAAgBF,CAAO,EAAI,SAASH,IAC3D,MAAMY,EACJ,SAAS,cAAc,eAAe,EAAE,sBAAuB,EAAC,OAChE,EAEFF,EAAiBT,EAAYW,CAAW,CAC5C,CAAG,GAGE,SAAS,cAAc,gBAAgB,GACtCE,EAAK,KAAK,OAASX,EAAQ,UAC5B,SAAS,cAAc,gBAAgB,GAAKH,IAASE,IAEtDM,EAAwB,gBAAgB,EAG1CF,EAAS,QAAO,CAClB"}