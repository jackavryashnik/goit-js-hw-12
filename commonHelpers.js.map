{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst input = document.querySelector('.search-input');\nconst btn = document.querySelector('.search-btn');\nconst gallery = document.querySelector('.gallery');\nlet page = 1;\nconst request = {\n  key: '41300766-2a2685b0426849001fa971f21',\n  q: '',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  per_page: 40,\n  page: page,\n};\nconst options = {\n  overlayOpacity: 0.8,\n  captionsData: 'alt',\n  captionDelay: 250,\n};\nlet URL = `https://pixabay.com/api/?`;\nconst lightbox = new SimpleLightbox('.gallery a', options);\n\nconst getImagesFromAPI = async (url, scrollHight) => {\n  await axios\n    .get(url)\n    .then(({ data }) => {\n      if (!data.hits[0]) {\n        iziToast.error({\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n          backgroundColor: '#EF4040',\n          messageColor: '#FAFAFB',\n          position: 'topRight',\n          iconUrl: '/img/bi_x-octagon.svg',\n          iconColor: '#ffffff',\n          maxWidth: 432,\n          messageSize: 16,\n        });\n\n        if (document.querySelector('.load-more-btn')) {\n          document.querySelector('.load-more-btn').remove();\n        }\n        gallery.innerHTML = '';\n        return;\n      }\n\n      const totalPages = Math.ceil(data.totalHits / request.per_page);\n\n      if (page === totalPages) {\n        iziToast.info({\n          message: \"We're sorry, but you've reached the end of search results.\",\n          position: 'topRight',\n          maxWidth: 432,\n          messageSize: 16,\n        });\n\n        if (document.querySelector('.load-more-btn')) {\n          document.querySelector('.load-more-btn').remove();\n        }\n\n        if (document.querySelector('.loader')) {\n          document.querySelector('.loader').remove();\n        }\n\n        return;\n      }\n\n      renderMarkup(data);\n\n      window.scrollBy({\n        top: scrollHight,\n        behavior: 'smooth',\n      });\n    })\n    .catch(error => {\n      console.log(error);\n    });\n};\n\nbtn.addEventListener('click', event => {\n  event.preventDefault();\n  if (document.querySelector('.loader')) {\n    document.querySelector('.loader').remove();\n  }\n  if (document.querySelector('.load-more-btn')) {\n    document.querySelector('.load-more-btn').remove();\n  }\n  gallery.insertAdjacentHTML('afterend', `<span class=\"loader\"></span>`);\n  page = 1;\n\n  request.q = input.value;\n  URL += new URLSearchParams(request);\n  input.value = '';\n  getImagesFromAPI(URL, 0);\n});\n\nconst renderMarkup = data => {\n  let markup = data.hits\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=${largeImageURL}>\n          <img class=\"gallery-image\" src=${webformatURL} data-source=${largeImageURL} alt=\"${tags}\" width=\"360\" height=\"200\"/>\n          <ul class=\"image-stats\">\n            <li class=\"stats-item\"><h3 class=\"stat-title\">Likes</h3><p class=\"stat-value\">${likes}</p></li>\n            <li class=\"stats-item\"><h3 class=\"stat-title\">Views</h3><p class=\"stat-value\">${views}</p></li>\n            <li class=\"stats-item\"><h3 class=\"stat-title\">Comments</h3><p class=\"stat-value\">${comments}</p></li>\n            <li class=\"stats-item\"><h3 class=\"stat-title\">Downloads</h3><p class=\"stat-value\">${downloads}</p></li>\n          </ul>  \n          </a>\n        </li>`;\n      }\n    )\n    .join('');\n\n  let loadMoreBtn = `<button type=\"submit\" class=\"load-more-btn\">Load more</button>`;\n\n  document.querySelector('.loader').remove();\n  gallery.insertAdjacentHTML('beforeend', markup);\n  gallery.insertAdjacentHTML('afterend', loadMoreBtn);\n  document.querySelector('.load-more-btn').addEventListener('click', event => {\n    event.preventDefault();\n    document.querySelector('.load-more-btn').remove();\n    gallery.insertAdjacentHTML('afterend', `<span class=\"loader\"></span>`);\n    page += 1;\n\n    URL += new URLSearchParams(request);\n    const scrollHight =\n      document.querySelector('.gallery-item').getBoundingClientRect().height *\n      2;\n\n    getImagesFromAPI(URL, scrollHight);\n  });\n\n  lightbox.refresh();\n};\n"],"names":["input","btn","gallery","page","request","options","URL","lightbox","SimpleLightbox","getImagesFromAPI","url","scrollHight","axios","data","iziToast","totalPages","renderMarkup","error","event","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","loadMoreBtn"],"mappings":"owBAMA,MAAMA,EAAQ,SAAS,cAAc,eAAe,EAC9CC,EAAM,SAAS,cAAc,aAAa,EAC1CC,EAAU,SAAS,cAAc,UAAU,EACjD,IAAIC,EAAO,EACX,MAAMC,EAAU,CACd,IAAK,qCACL,EAAG,GACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,GACV,KAAMD,CACR,EACME,EAAU,CACd,eAAgB,GAChB,aAAc,MACd,aAAc,GAChB,EACA,IAAIC,EAAM,4BACV,MAAMC,EAAW,IAAIC,EAAe,aAAcH,CAAO,EAEnDI,EAAmB,MAAOC,EAAKC,IAAgB,CACnD,MAAMC,EACH,IAAIF,CAAG,EACP,KAAK,CAAC,CAAE,KAAAG,KAAW,CAClB,GAAI,CAACA,EAAK,KAAK,GAAI,CACjBC,EAAS,MAAM,CACb,QACE,2EACF,gBAAiB,UACjB,aAAc,UACd,SAAU,WACV,QAAS,wBACT,UAAW,UACX,SAAU,IACV,YAAa,EACvB,CAAS,EAEG,SAAS,cAAc,gBAAgB,GACzC,SAAS,cAAc,gBAAgB,EAAE,OAAM,EAEjDZ,EAAQ,UAAY,GACpB,MACD,CAED,MAAMa,EAAa,KAAK,KAAKF,EAAK,UAAYT,EAAQ,QAAQ,EAE9D,GAAID,IAASY,EAAY,CACvBD,EAAS,KAAK,CACZ,QAAS,6DACT,SAAU,WACV,SAAU,IACV,YAAa,EACvB,CAAS,EAEG,SAAS,cAAc,gBAAgB,GACzC,SAAS,cAAc,gBAAgB,EAAE,OAAM,EAG7C,SAAS,cAAc,SAAS,GAClC,SAAS,cAAc,SAAS,EAAE,OAAM,EAG1C,MACD,CAEDE,EAAaH,CAAI,EAEjB,OAAO,SAAS,CACd,IAAKF,EACL,SAAU,QAClB,CAAO,CACP,CAAK,EACA,MAAMM,GAAS,CACd,QAAQ,IAAIA,CAAK,CACvB,CAAK,CACL,EAEAhB,EAAI,iBAAiB,QAASiB,GAAS,CACrCA,EAAM,eAAc,EAChB,SAAS,cAAc,SAAS,GAClC,SAAS,cAAc,SAAS,EAAE,OAAM,EAEtC,SAAS,cAAc,gBAAgB,GACzC,SAAS,cAAc,gBAAgB,EAAE,OAAM,EAEjDhB,EAAQ,mBAAmB,WAAY,8BAA8B,EACrEC,EAAO,EAEPC,EAAQ,EAAIJ,EAAM,MAClBM,GAAO,IAAI,gBAAgBF,CAAO,EAClCJ,EAAM,MAAQ,GACdS,EAAiBH,EAAK,CAAC,CACzB,CAAC,EAED,MAAMU,EAAeH,GAAQ,CAC3B,IAAIM,EAASN,EAAK,KACf,IACC,CAAC,CACC,aAAAO,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IACe;AAAA,uCACwBL;AAAA,2CACID,iBAA4BC,UAAsBC;AAAA;AAAA,4FAEDC;AAAA,4FACAC;AAAA,+FACGC;AAAA,gGACCC;AAAA;AAAA;AAAA,cAK3F,EACA,KAAK,EAAE,EAENC,EAAc,iEAElB,SAAS,cAAc,SAAS,EAAE,OAAM,EACxCzB,EAAQ,mBAAmB,YAAaiB,CAAM,EAC9CjB,EAAQ,mBAAmB,WAAYyB,CAAW,EAClD,SAAS,cAAc,gBAAgB,EAAE,iBAAiB,QAAST,GAAS,CAC1EA,EAAM,eAAc,EACpB,SAAS,cAAc,gBAAgB,EAAE,OAAM,EAC/ChB,EAAQ,mBAAmB,WAAY,8BAA8B,EACrEC,GAAQ,EAERG,GAAO,IAAI,gBAAgBF,CAAO,EAClC,MAAMO,EACJ,SAAS,cAAc,eAAe,EAAE,sBAAuB,EAAC,OAChE,EAEFF,EAAiBH,EAAKK,CAAW,CACrC,CAAG,EAEDJ,EAAS,QAAO,CAClB"}