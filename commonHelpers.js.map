{"version":3,"file":"commonHelpers.js","sources":["../src/img/bi_x-octagon.svg","../src/main.js"],"sourcesContent":["export default \"__VITE_ASSET__3108d0c6__\"","import 'simplelightbox/dist/simple-lightbox.min.css';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport icon from './img/bi_x-octagon.svg';\nimport iziToast from 'izitoast';\nimport axios from 'axios';\n\nconst input = document.querySelector('.search-input');\nconst form = document.querySelector('.search-form');\nconst gallery = document.querySelector('.gallery');\nlet page = 1;\nlet previousSearchValue = '';\nconst request = {\n  key: '41300766-2a2685b0426849001fa971f21',\n  q: '',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  per_page: 40,\n};\nconst lightboxOptions = {\n  overlayOpacity: 0.8,\n  captionsData: 'alt',\n  captionDelay: 250,\n};\nlet URL = `https://pixabay.com/api/?`;\nconst lightbox = new SimpleLightbox('.gallery a', lightboxOptions);\n\nconst removeElemenyBySelector = selestor => {\n  if (document.querySelector(selestor))\n    document.querySelector(selestor).remove();\n};\n\nconst getImagesFromAPI = async (url, scrollHight) => {\n  await axios\n    .get(url)\n    .then(({ data }) => {\n      if (data.hits.length === 0) {\n        iziToast.error({\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n          backgroundColor: '#EF4040',\n          messageColor: '#FAFAFB',\n          position: 'topRight',\n          iconUrl: icon,\n          iconColor: '#ffffff',\n          maxWidth: 432,\n          messageSize: 16,\n        });\n\n        removeElemenyBySelector('.loader');\n        removeElemenyBySelector('.load-more-btn');\n\n        gallery.innerHTML = '';\n        return;\n      }\n\n      const totalPages = Math.ceil(data.totalHits / request.per_page);\n\n      if (data.totalHits <= request.per_page || page === totalPages) {\n        iziToast.info({\n          message: \"We're sorry, but you've reached the end of search results.\",\n          position: 'topRight',\n          maxWidth: 432,\n          messageSize: 16,\n        });\n\n        if (data.totalHits <= request.per_page) {\n          renderMarkup(data);\n        }\n        removeElemenyBySelector('.loader');\n        removeElemenyBySelector('.load-more-btn');\n        return;\n      }\n\n      renderMarkup(data);\n\n      window.scrollBy({\n        top: scrollHight,\n        behavior: 'smooth',\n      });\n    })\n    .catch(error => {\n      removeElemenyBySelector('.loader');\n      console.log(error);\n    });\n};\n\nform.addEventListener('submit', event => {\n  event.preventDefault();\n\n  if (previousSearchValue !== input.value) {\n    gallery.innerHTML = '';\n    request.q = input.value;\n  }\n  removeElemenyBySelector('.loader');\n  removeElemenyBySelector('.load-more-btn');\n\n  gallery.insertAdjacentHTML('afterend', `<span class=\"loader\"></span>`);\n  page = 1;\n\n  const currentURL = URL + new URLSearchParams(request) + `&page=${page}`;\n  input.value = '';\n  getImagesFromAPI(currentURL, 0);\n});\n\nconst renderMarkup = data => {\n  let markup = data.hits\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=${largeImageURL}>\n          <img class=\"gallery-image\" src=${webformatURL} data-source=${largeImageURL} alt=\"${tags}\" width=\"360\" height=\"200\"/>\n          <ul class=\"image-stats\">\n            <li class=\"stats-item\"><h3 class=\"stat-title\">Likes</h3><p class=\"stat-value\">${likes}</p></li>\n            <li class=\"stats-item\"><h3 class=\"stat-title\">Views</h3><p class=\"stat-value\">${views}</p></li>\n            <li class=\"stats-item\"><h3 class=\"stat-title\">Comments</h3><p class=\"stat-value\">${comments}</p></li>\n            <li class=\"stats-item\"><h3 class=\"stat-title\">Downloads</h3><p class=\"stat-value\">${downloads}</p></li>\n          </ul>  \n          </a>\n        </li>`;\n      }\n    )\n    .join('');\n\n  let loadMoreBtn = `<button type=\"submit\" class=\"load-more-btn\">Load more</button>`;\n\n  document.querySelector('.loader').remove();\n  gallery.insertAdjacentHTML('beforeend', markup);\n  gallery.insertAdjacentHTML('afterend', loadMoreBtn);\n  document.querySelector('.load-more-btn').addEventListener('click', event => {\n    event.preventDefault();\n    document.querySelector('.load-more-btn').remove();\n    gallery.insertAdjacentHTML('afterend', `<span class=\"loader\"></span>`);\n    page += 1;\n\n    const currentURL = URL + new URLSearchParams(request) + `&page=${page}`;\n    const scrollHight =\n      document.querySelector('.gallery-item').getBoundingClientRect().height *\n      2;\n\n    getImagesFromAPI(currentURL, scrollHight);\n  });\n\n  lightbox.refresh();\n};\n"],"names":["icon","input","form","gallery","page","previousSearchValue","request","lightboxOptions","URL","lightbox","SimpleLightbox","removeElemenyBySelector","selestor","getImagesFromAPI","url","scrollHight","axios","data","iziToast","totalPages","renderMarkup","error","event","currentURL","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","loadMoreBtn"],"mappings":"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"}